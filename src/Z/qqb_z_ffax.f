!
!  SPDX-License-Identifier: GPL-3.0-or-later
!  Copyright (C) 2019-2022, respective authors of MCFM.
!

      subroutine qqcoeff3_ax(qsq, musq, Fax_s)
          use types
          implicit complex(dp) (T)

          include 'src/Inc/constants.f'
          include 'src/Inc/masses.f'
          real(dp), intent(in) :: qsq, musq
          complex(dp), intent(out) :: Fax_s(3)

          complex(dp) :: HPL1, HPL2, HPL3, HPL4
          real(dp) :: x, Logx, LoguOs
          complex(dp) :: y
          real(dp), parameter :: nl = 5._dp, nh = 1._dp

          complex(dp) :: T1(4)

          Fax_s(:) = 0._dp

          x = qsq/mt**2
          Logx = log(x)
          LoguOs = log(musq/qsq)

          ! solution of x = 2-y-1/y with pos. imaginary part
          y = (2._dp - x + im*sqrt(4._dp-x)*sqrt(x) )/2._dp


      T2=y**4
      T3=y**3
      T4=5.3333333333333333333D0*CF*nh*T2
      T5=-21.333333333333333333D0*CF*nh*T3
      T6=21.333333333333333333D0*CF*nh*y
      T7=5.3333333333333333333D0*CF*nh
      T8=T4+T5+T6-T7
      T9=y*y
      T10=-24.888888888888888889D0*CF*nh*T2+120.88888888888888889D0*CF*n
     &h*T3-192.0D0*CF*nh*T9+120.88888888888888889D0*CF*nh*y-24.888888888
     &888888889D0*CF*nh
      T11=pi*pi
      T12=-7.1111111111111111111D0*CF*nh*T11+311.7037037037037037D0*CF*n
     &h
      T13=1.7777777777777777778D0*CF*nh*T11
      T14=-67.259259259259259259D0*CF*nh
      T15=(T13+T14)*T2
      T16=-7.1111111111111111111D0*CF*nh*T11
      T17=-10.666666666666666667D0*CF*nh
      T18=62.0D0*CA*CF
      T19=-0.88888888888888888889D0*CF*LoguOs-5.4814814814814814815D0*CF
      T20=CF*CF
      T21=8.0D0*CF*LoguOs+25.333333333333333333D0*CF
      T22=4.0D0*CF*LoguOs*LoguOs+25.333333333333333333D0*CF*LoguOs+52.11
     &1111111111111111D0*CF
      T23=LoguOs*LoguOs
      T24=66.0D0*T20
      T25=-179.33333333333333333D0*CA*CF
      T26=pi**4
      T27=pi**3
      T28=3.5555555555555555556D0*CF*LoguOs
      T29=-32.0D0*CF*LoguOs-101.33333333333333333D0*CF
      T30=-16.0D0*CF*T23
      T31=-101.33333333333333333D0*CF*LoguOs
      T32=-264.0D0*T20
      T33=717.33333333333333333D0*CA*CF
      T34=-5.3333333333333333333D0*CF*LoguOs
      T35=48.0D0*CF*LoguOs+152.0D0*CF
      T36=24.0D0*CF*T23
      T37=152.0D0*CF*LoguOs
      T38=396.0D0*T20
      T39=-1076.0D0*CA*CF
      T40=(2.1333333333333333333D0*T20+0.75555555555555555555D0*CA*CF)*T
     &26+(3.5555555555555555556D0*CF*im*nl+3.5555555555555555556D0*CF*im
     &*nh-19.555555555555555556D0*CA*CF*im)*T27+((T28+21.925925925925925
     &926D0*CF)*nl+(T28+25.481481481481481481D0*CF)*nh-19.55555555555555
     &5556D0*CA*CF*LoguOs+21.333333333333333333D0*T20-145.03703703703703
     &704D0*CA*CF)*T11+(T29*im*nl+T29*im*nh+(176.0D0*CA*CF*LoguOs+T32+T3
     &3)*im)*pi+(T30+T31-208.44444444444444444D0*CF)*nl+(T30+T31-247.851
     &85185185185185D0*CF)*nh+88.0D0*CA*CF*T23+(T32+T33)*LoguOs-818.0D0*
     &T20+1645.1111111111111111D0*CA*CF
      T41=(-0.53333333333333333333D0*T20-0.18888888888888888889D0*CA*CF)
     &*T26
      T42=(-0.88888888888888888889D0*CF*im*nl-0.88888888888888888889D0*C
     &F*im*nh+4.8888888888888888889D0*CA*CF*im)*T27
      T43=(T19*nl+T19*nh+4.8888888888888888889D0*CA*CF*LoguOs-5.33333333
     &33333333333D0*T20+36.259259259259259259D0*CA*CF)*T11
      T44=(T21*im*nl+T21*im*nh+(-44.0D0*CA*CF*LoguOs+T24+T25)*im)*pi
      T45=T22*nl
      T46=T22*nh
      T47=-22.0D0*CA*CF*T23
      T48=(T24+T25)*LoguOs
      T49=204.5D0*T20
      T50=-411.27777777777777778D0*CA*CF
      T51=HPL3(1,0,0,y)
      T52=HPL3(0,1,0,y)
      T53=-32.0D0*CF*T3
      T54=-32.0D0*CF*y
      T55=HPL3(0,0,1,y)
      T56=HPL3(0,0,0,y)
      T57=T53+64.0D0*CF*T9+T54
      T58=HPL2(1,1,y)
      T59=32.0D0*CF*y
      T60=HPL2(1,0,y)
      T61=-32.0D0*CF*T2
      T62=-160.0D0*CF*T3
      T63=160.0D0*CF*T9
      T64=HPL2(0,1,y)
      T65=16.0D0*CF*im*pi
      T66=-16.0D0*CF*Logx
      T67=HPL2(0,0,y)
      T68=32.0D0*CF*T3
      T69=64.0D0*CF*im*pi+176.0D0*CF
      T70=24.0D0*CF
      T71=HPL1(1,y)
      T72=18.0D0*CF
      T73=2.6666666666666666667D0*CF*T11
      T74=80.0D0*CF*im*pi
      T75=48.0D0*CF*Logx
      T76=8.0D0*CF*Logx
      T77=HPL1(0,y)
      T78=-6.0D0*CF*LoguOs
      T79=Logx*Logx
      T80=108.0D0*CF
      T81=-88.0D0*CF*im*pi
      T82=16.0D0*CF*T79
      T83=112.0D0*CF*Logx
      T84=24.0D0*CF*LoguOs
      T85=72.0D0*CF
      T86=-12.0D0*CF*im*pi
      T87=4.0D0*CF*T79
      T88=6.0D0*CF*Logx
      T89=T2-4.0D0*T3+6.0D0*T9-4.0D0*y+1.0D0
      T90=0.60104457945842104114D-7*CF*LoguOs
      T91=0.36659294408553839217D-7*T20
      T92=x**10
      T93=0.29777739302450576D-6*CF*LoguOs
      T94=0.18524423054491811974D-6*T20
      T95=x**9
      T96=0.0000015096108815068739334D0*CF*LoguOs
      T97=0.95902430601742425238D-6*T20
      T98=x**8
      T99=0.0000078759674410936728866D0*CF*LoguOs
      T100=0.0000051155076901486576468D0*T20
      T101=x**7
      T102=0.000042634404899124306701D0*CF*LoguOs
      T103=0.000028336535868119930316D0*T20
      T104=x**6
      T105=0.00024243772749235540413D0*CF*LoguOs
      T106=0.00016489372725200389599D0*T20
      T107=x**5
      T108=0.0014775062288289801517D0*CF*LoguOs
      T109=0.0010261022927689594356D0*T20
      T110=x**4
      T111=0.010004535147392290249D0*CF*LoguOs
      T112=0.0070343915343915343915D0*T20
      T113=x**3
      T114=0.081234567901234567902D0*CF*LoguOs
      T115=0.056172839506172839506D0*T20
      T116=x*x
      T117=0.98765432098765432099D0*CF*LoguOs
      T118=8.0D0*CF*LoguOs
      T119=4.0D0*CF*T23
      T120=(T118-2.6666666666666666667D0*CF)*Logx
      T121=-2.6666666666666666667D0*CF*LoguOs
      T122=-44.0D0*CA*CF*LoguOs
      T123=-25.333333333333333333D0*CA*CF
      T1(1)=0.66666666666666666667D0*CF*T11-6.0D0*CF*im*pi+T78-T72
      T124=(T4+T5+32.0D0*CF*nh*T9-T6+T7)*T51+(10.666666666666666667D0*CF
     &*nh*T2-42.666666666666666667D0*CF*nh*T3+42.666666666666666667D0*CF
     &*nh*y+T17)*HPL3(0,1,1,y)+T8*T52+T8*T55+(T4+T5+16.0D0*C
     &F*nh*T9)*T56+(-49.777777777777777778D0*CF*nh*T2+241.77777777777777
     &778D0*CF*nh*T3-384.0D0*CF*nh*T9+241.77777777777777778D0*CF*nh*y-49
     &.777777777777777778D0*CF*nh)*T58+T10*T60+T10*T64+(T5+58.6666666666
     &66666667D0*CF*nh*T9-T6)*T67+(T15+T12*T3+(10.666666666666666667D0*C
     &F*nh*T11-488.88888888888888889D0*CF*nh)*T9+T12*y+T13+T14)*T71+(T15
     &+(T16+260.14814814814814815D0*CF*nh)*T3+(5.3333333333333333333D0*C
     &F*nh*T11-244.44444444444444444D0*CF*nh)*T9+51.555555555555555556D0
     &*CF*nh*y)*T77+((T17+T18)*T2+(42.666666666666666667D0*CF*nh-248.0D0
     &*CA*CF)*T3+(-32.0D0*CF*nh+372.0D0*CA*CF)*T9-248.0D0*CA*CF*y+T18)*z
     &eta3+(T41+T42+T43+T44+T45+T46+T47+T48+T49+T50)*T2+T40*T3+((-3.2D0*
     &T20-1.1333333333333333333D0*CA*CF)*T26+(-5.3333333333333333333D0*C
     &F*im*nl-5.3333333333333333333D0*CF*im*nh+29.333333333333333333D0*C
     &A*CF*im)*T27+((T34-32.888888888888888889D0*CF)*nl+(T34-40.0D0*CF)*
     &nh+29.333333333333333333D0*CA*CF*LoguOs-32.0D0*T20+217.55555555555
     &555556D0*CA*CF)*T11+(T35*im*nl+T35*im*nh+(-264.0D0*CA*CF*LoguOs+T3
     &8+T39)*im)*pi+(T36+T37+312.66666666666666667D0*CF)*nl+(T36+T37+391
     &.48148148148148148D0*CF)*nh-132.0D0*CA*CF*T23+(T38+T39)*LoguOs+122
     &7.0D0*T20-2467.6666666666666667D0*CA*CF)*T9
      T1(2)=(T124+T40*y+T41+T42+T43+T44+T45+T46+T47+T48+T49+T50)/T89
      T125=(-64.0D0*CF*T3+128.0D0*CF*T9-64.0D0*CF*y)*T51+(T53+48.0D0*CF*
     &T9+T54)*T52+T57*T55+(-48.0D0*CF*T3+88.0D0*CF*T9-48.0D0*CF*y)*T56+T
     &57*HPL3(0,-1,0,y)+(T61-128.0D0*CF*T3+320.0D0*CF*T9-128
     &.0D0*CF*y-32.0D0*CF)*T58+(-28.0D0*CF*T2+T62+T63+T59-4.0D0*CF)*T60+
     &(T61+T62+T63+T59)*T64+(-4.0D0*CF*T2+(T65+160.0D0*CF*im*im+T66)*T3+
     &(-32.0D0*CF*im*pi+32.0D0*CF*Logx+T80)*T9+(T65+T66+64.0D0*CF)*y+8.0
     &D0*CF)*T67+(-16.0D0*CF*T2+T68-T59+16.0D0*CF)*HPL2(-1,0,y)+
     &((T65+T70)*T2+T69*T3+(-160.0D0*CF*im*pi-400.0D0*CF)*T9+T69*y+T65+T
     &70)*T71+((T65-T76+T72)*T2+(-T73+T74-T75+76.0D0*CF)*T3+(T73-T74-200
     &.0D0*CF)*T9+(-T73-T65+T75+100.0D0*CF)*y+T76+6.0D0*CF)*T77+(-16.0D0
     &*CF*T3-16.0D0*CF*y)*zeta3+(3.3333333333333333333D0*CF*T11+T86+T87+
     &T88+T78-T72)*T2+(18.666666666666666667D0*CF*T11+T81+T82+T83+T84+T8
     &5)*T3+(-40.0D0*CF*T11+200.0D0*CF*im*pi-40.0D0*CF*T79-236.0D0*CF*Lo
     &gx-36.0D0*CF*LoguOs-T80)*T9
      T1(3)=(T125+(13.333333333333333333D0*CF*T11+T81+T82+T83+T84+T85)*y
     &+4.6666666666666666667D0*CF*T11+T86+T87+T88+T78-T72)/T89
      T126=(-0.0000056230721260456509118D0*CF*nh-145.07413449708959267D0
     &*T20-1.6648871355480220784D0*CA*CF)*T92+(-0.0000218465836324508982
     &77D0*CF*nh-129.15566415209038935D0*T20-1.77095793408876844D0*CA*CF
     &)*T95+(-0.000084820008605338107036D0*CF*nh-113.25292014341243081D0
     &*T20-1.9161828250449913353D0*CA*CF)*T98+(-0.0003292689194764803957
     &1D0*CF*nh-97.37262030227341787D0*T20-2.0473992327578601447D0*CA*CF
     &)*T101+(-0.0012794281356036663055D0*CF*nh-81.527168431750955801D0*
     &T20-2.2402055657714466038D0*CA*CF)*T104+(-0.0049873722924126519097
     &D0*CF*nh-65.74224353734721009D0*T20-2.390042383374900745D0*CA*CF)*
     &T107+(-0.019598134358723958333D0*CF*nh-50.077658853076753162D0*T20
     &-2.6338689861600361173D0*CA*CF)*T110+(-0.078499348958333333334D0*C
     &F*nh-34.691200474330357143D0*T20-2.7171934136284722222D0*CA*CF)*T1
     &13+(-0.32964409722222222222D0*CF*nh-20.099262152777777778D0*T20-2.
     &8244429976851851852D0*CA*CF)*T116+(-1.5555555555555555556D0*CF*nh-
     &9.7916666666666666667D0*T20-2.4375D0*CA*CF)*x-72.0D0*T20+84.0D0*CA
     &*CF
      T127=T126*zeta3+((0.20034513170610584783D-7*CF*im*nl+(T91+0.670305
     &4769113011467D-7*CA*CF)*im)*pi+(0.40069944775231519331D-7*CF*Logx+
     &T90+0.15042840097489236495D-6*CF)*nl+(0.60104457945842104114D-7*CF
     &*Logx+T90+0.0000067705809580133102144D0*CF)*nh+(-T91-0.39760506639
     &32616873D-6*CA*CF)*Logx-0.33057451870213157263D-6*CA*CF*LoguOs+174
     &.38736325653719375D0*T20+2.0012886776644421665D0*CA*CF)*T92+((0.97
     &498111695816295998D-7*CF*im*nl+(T94+0.30930322029712102304D-6*CA*C
     &F)*im)*pi+(0.200279281328689464D-6*CF*Logx+T93+0.72524678904644470
     &672D-6*CF)*nl+(0.29777739302450576D-6*CF*Logx+T93+0.00002630977659
     &4020318951D0*CF)*nh+(-T94-0.000001947078881931902703D0*CA*CF)*Logx
     &-0.00000163777566163478168D0*CA*CF*LoguOs+155.25245042338058281D0*
     &T20+2.1287902490022527525D0*CA*CF)*T95+((0.48379496455022961922D-6
     &*CF*im*nl+(T97+0.0000014414731876469658002D0*CA*CF)*im)*pi+(0.0000
     &010258159169566443142D0*CF*Logx+T96+0.0000035605363208056703521D0*
     &CF)*nl+(0.0000015096108815068739334D0*CF*Logx+T96+0.00010216321750
     &413826366D0*CF)*nh+(-T97-0.0000097443330359347724341D0*CA*CF)*Logx
     &-0.0000083028598482878066339D0*CA*CF*LoguOs+136.13642094731638407D
     &0*T20+2.3033509021239535147D0*CA*CF)*T98
      T128=T127+((0.0000024585937284349982763D0*CF*im*nl+(T100+0.0000067
     &912310282869617715D0*CA*CF)*im)*pi+(0.0000054173737126586746103D0*
     &CF*Logx+T99+0.000017868624626319565509D0*CF)*nl+(0.000007875967441
     &0936728866D0*CF*Logx+T99+0.00039659205961893602279D0*CF)*nh+(-T100
     &-0.000050109051954302162648D0*CA*CF)*Logx-0.0000433178209260152008
     &76D0*CA*CF*LoguOs+117.04727380761007561D0*T20+2.461039265203586874
     &8D0*CA*CF)*T101+((0.000012874502670421037768D0*CF*im*nl+(T103+0.00
     &0032362747346955315857D0*CA*CF)*im)*pi+(0.000029759902228703268933
     &D0*CF*Logx+T102+0.000092137541128727929724D0*CF)*nl+(0.00004263440
     &4899124306701D0*CF*Logx+T102+0.0015403501578013723582D0*CF)*nh+(-T
     &103-0.00026685197429213900271D0*CA*CF)*Logx-0.00023448922694518368
     &685D0*CA*CF*LoguOs+97.99955518507079875D0*T20+2.692582264089992880
     &4D0*CA*CF)*T104+((0.000070088641517212945785D0*CF*im*nl+(T106+0.00
     &015585324504447709285D0*CA*CF)*im)*pi+(0.00017234908597514245834D0
     &*CF*Logx+T105+0.00049150304911007022977D0*CF)*nl+(0.00024243772749
     &235540413D0*CF*Logx+T105+0.0059946974915012570448D0*CF)*nh+(-T106-
     &0.0014892607462524318155D0*CA*CF)*Logx-0.0013334075012079547227D0*
     &CA*CF*LoguOs+79.022380495949755209D0*T20+2.871459556706388756D0*CA
     &*CF)*T107
      T129=T128+((0.0004021164021164021164D0*CF*im*nl+(T109+0.0007543013
     &9133842837547D0*CA*CF)*im)*pi+(0.0010753898267125780353D0*CF*Logx+
     &T108+0.0027364480366579971854D0*CF)*nl+(0.0014775062288289801517D0
     &*CF*Logx+T108+0.023435616307893881575D0*CF)*nh+(-T109-0.0088805856
     &4989781921D0*CA*CF)*Logx-0.0081262842585593908345D0*CA*CF*LoguOs+6
     &0.179260156243177552D0*T20+3.1572925358625377637D0*CA*CF)*T110+((0
     &.0024867724867724867725D0*CF*im*nl+(T112+0.0035859788359788359788D
     &0*CA*CF)*im)*pi+(0.007517762660619803477D0*CF*Logx+T111+0.01603279
     &3434834251161D0*CF)*nl+(0.010004535147392290249D0*CF*Logx+T111+0.0
     &92283913414902998237D0*CF)*nh+(-T112-0.058610922146636432351D0*CA*
     &CF)*Logx-0.055024943310657596372D0*CA*CF*LoguOs+41.622463141659055
     &598D0*T20+3.211948351245122167D0*CA*CF)*T113+((0.01728395061728395
     &0617D0*CF*im*nl+(T115+0.014969135802469135802D0*CA*CF)*im)*pi+(0.0
     &63950617283950617284D0*CF*Logx+T114+0.096765432098765432099D0*CF)*
     &nl+(0.081234567901234567902D0*CF*Logx+T114+0.36101787551440329218D
     &0*CF)*nh+(-T115-0.46175925925925925926D0*CA*CF)*Logx-0.44679012345
     &679012346D0*CA*CF*LoguOs+23.883304398148148148D0*T20+3.04124852109
     &05349794D0*CA*CF)*T116
      T1(4)=T129+((0.14814814814814814815D0*CF*im*nl+0.59259259259259259
     &259D0*T20*im)*pi+(0.83950617283950617284D0*CF*Logx+T117+0.24691358
     &024691358025D0*CF)*nl+(0.98765432098765432099D0*CF*Logx+T117+0.847
     &73662551440329218D0*CF)*nh+(-0.59259259259259259259D0*T20-5.432098
     &7654320987654D0*CA*CF)*Logx-5.4320987654320987654D0*CA*CF*LoguOs+1
     &4.095679012345679012D0*T20+1.825617283950617284D0*CA*CF)*x+(T87+T1
     &20+T119+T121+20.777777777777777778D0*CF)*nl+(T87+T120+T119+T121+8.
     &7777777777777777778D0*CF)*nh-22.0D0*CA*CF*T79+(T122+T24+T123)*Logx
     &+T47+(T24+T123)*LoguOs-49.5D0*T20-91.611111111111111111D0*CA*CF

      ! T1 : two-loop F_{s,b}^A in notation of 2109.01917, eq (2.4) (FRab2)
      ! T2 : two-loop F_{s,t}^A
      ! T3 : three-loop F_{s,b}^A
      ! T4 : three-loop F_{s,t}^A

      Fax_s(2) = T1(1) - T1(3)
      Fax_s(3) = T1(2) - T1(4)

      ! top-quark decoupled:
      !Fax_s(2) = T1(1)
      !Fax_s(3) = T1(2) + 2*(nh*2/3*LoguOs)*T1(1)

      end subroutine
