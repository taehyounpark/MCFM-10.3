!
!  SPDX-License-Identifier: GPL-3.0-or-later
!  Copyright (C) 2019-2022, respective authors of MCFM.
!

      subroutine qqb_gam2j_g_mad(p,msq)
      implicit none
      include 'mxpart.f'
      include 'nf.f'
      include 'flags.f'
      integer j,k,m,n
      double precision p(mxpart,4),msq(-nf:nf,-nf:nf),
     & msq4(-nf:nf,-nf:nf,-nf:nf,-nf:nf),
     & msq4save(-nf:nf,-nf:nf,-nf:nf,-nf:nf)

c--- matrix elements computed by Madgraph for the phase space point:
c n        E             px             py              pz               m
c 1   0.5000000E+03  0.0000000E+00  0.0000000E+00  0.5000000E+03  0.0000000E+00
c 2   0.5000000E+03  0.0000000E+00  0.0000000E+00 -0.5000000E+03  0.0000000E+00
c 3   0.8855133E+02 -0.2210069E+02  0.4008035E+02 -0.7580543E+02  0.3015783E-05
c 4   0.3283294E+03 -0.1038496E+03 -0.3019338E+03  0.7649492E+02  0.2132481E-05
c 5   0.1523581E+03 -0.1058810E+03 -0.9770964E+02  0.4954839E+02  0.2523185E-05
c 6   0.4307611E+03  0.2318313E+03  0.3595630E+03 -0.5023788E+02  0.1112166E-04

c photon is momentum 3 and gluon 6
c for 4-quark process, ordering of quark/antiquark in final state matches
c  the ordering in the initial state

      p(1,4)=-0.5000000d+03
      p(1,1)=0.0000000d+00
      p(1,2)=0.0000000d+00
      p(1,3)=-0.5000000d+03
      p(2,4)=-0.5000000d+03
      p(2,1)=0.0000000d+00
      p(2,2)=0.0000000d+00
      p(2,3)=0.5000000d+03
      p(3,4)=0.8855133d+02
      p(3,1)=-0.2210069d+02
      p(3,2)=0.4008035d+02
      p(3,3)=-0.7580543d+02
      p(4,4)=0.3283294d+03
      p(4,1)=-0.1038496d+03
      p(4,2)=-0.3019338d+03
      p(4,3)=0.7649492d+02
      p(5,4)=0.1523581d+03
      p(5,1)=-0.1058810d+03
      p(5,2)=-0.9770964d+02
      p(5,3)=0.4954839d+02
      p(6,4)=0.4307611d+03
      p(6,1)=0.2318313d+03
      p(6,2)=0.3595630d+03
      p(6,3)=-0.5023788d+02

      msq4(:,:,:,:)=0d0

      if (Qflag) then
      msq4(-4,-4,-4,-4) =   2.2141417d-08
      msq4(-4,-3,-4,-3) =   6.53442134d-09
      msq4(-4,-2,-4,-2) =   1.34747573d-08
      msq4(-4,-1,-4,-1) =   6.53442134d-09
      msq4(-4,+1,-4,+1) =   4.33211586d-09
      msq4(-4,+2,-4,+2) =   3.22314149d-08
      msq4(-4,+3,-4,+3) =   4.33211586d-09
      msq4(-4,+4,-4,+4) =   5.23542903d-08
      msq4(-4,+4,-3,+3) =   1.64142402d-08
      msq4(-4,+4,-2,+2) =   1.86666079d-08
      msq4(-4,+4,-1,+1) =   1.64142402d-08
      msq4(-3,-4,-3,-4) =   1.85647923d-08
      msq4(-3,-3,-3,-3) =   5.53535425d-09
      msq4(-3,-2,-3,-2) =   1.85647923d-08
      msq4(-3,-1,-3,-1) =   3.36868932d-09
      msq4(-3,+1,-3,+1) =   8.05785374d-09
      msq4(-3,+2,-3,+2) =   2.28150931d-08
      msq4(-3,+3,-4,+4) =   3.63272481d-09
      msq4(-3,+3,-3,+3) =   1.30885726d-08
      msq4(-3,+3,-2,+2) =   3.63272481d-09
      msq4(-3,+3,-1,+1) =   4.66665198d-09
      msq4(-3,+4,-3,+4) =   2.28150931d-08
      msq4(-2,-4,-2,-4) =   1.34747573d-08
      msq4(-2,-3,-2,-3) =   6.53442134d-09
      msq4(-2,-2,-2,-2) =   2.2141417d-08
      msq4(-2,-1,-2,-1) =   6.53442134d-09
      msq4(-2,+1,-2,+1) =   4.33211586d-09
      msq4(-2,+2,-4,+4) =   1.86666079d-08
      msq4(-2,+2,-3,+3) =   1.64142402d-08
      msq4(-2,+2,-2,+2) =   5.23542903d-08
      msq4(-2,+2,-1,+1) =   1.64142402d-08
      msq4(-2,+3,-2,+3) =   4.33211586d-09
      msq4(-2,+4,-2,+4) =   3.22314149d-08
      msq4(-1,-4,-1,-4) =   1.85647923d-08
      msq4(-1,-3,-1,-3) =   3.36868932d-09
      msq4(-1,-2,-1,-2) =   1.85647923d-08
      msq4(-1,-1,-1,-1) =   5.53535425d-09
      msq4(-1,+1,-4,+4) =   3.63272481d-09
      msq4(-1,+1,-3,+3) =   4.66665198d-09
      msq4(-1,+1,-2,+2) =   3.63272481d-09
      msq4(-1,+1,-1,+1) =   1.30885726d-08
      msq4(-1,+2,-1,+2) =   2.28150931d-08
      msq4(-1,+3,-1,+3) =   8.05785374d-09
      msq4(-1,+4,-1,+4) =   2.28150931d-08
      msq4(+1,-4,+1,-4) =   2.28150931d-08
      msq4(+1,-3,+1,-3) =   8.05785374d-09
      msq4(+1,-2,+1,-2) =   2.28150931d-08
      msq4(+1,-1,+1,-1) =   1.30885726d-08
      msq4(+1,-1,+2,-2) =   3.63272481d-09
      msq4(+1,-1,+3,-3) =   4.66665198d-09
      msq4(+1,-1,+4,-4) =   3.63272481d-09
      msq4(+1,+1,+1,+1) =   5.53535425d-09
      msq4(+1,+2,+1,+2) =   1.85647923d-08
      msq4(+1,+3,+1,+3) =   3.36868932d-09
      msq4(+1,+4,+1,+4) =   1.85647923d-08
      msq4(+2,-4,+2,-4) =   3.22314149d-08
      msq4(+2,-3,+2,-3) =   4.33211586d-09
      msq4(+2,-2,+1,-1) =   1.64142402d-08
      msq4(+2,-2,+2,-2) =   5.23542903d-08
      msq4(+2,-2,+3,-3) =   1.64142402d-08
      msq4(+2,-2,+4,-4) =   1.86666079d-08
      msq4(+2,-1,+2,-1) =   4.33211586d-09
      msq4(+2,+1,+2,+1) =   6.53442134d-09
      msq4(+2,+2,+2,+2) =   2.2141417d-08
      msq4(+2,+3,+2,+3) =   6.53442134d-09
      msq4(+2,+4,+2,+4) =   1.34747573d-08
      msq4(+3,-4,+3,-4) =   2.28150931d-08
      msq4(+3,-3,+1,-1) =   4.66665198d-09
      msq4(+3,-3,+2,-2) =   3.63272481d-09
      msq4(+3,-3,+3,-3) =   1.30885726d-08
      msq4(+3,-3,+4,-4) =   3.63272481d-09
      msq4(+3,-2,+3,-2) =   2.28150931d-08
      msq4(+3,-1,+3,-1) =   8.05785374d-09
      msq4(+3,+1,+3,+1) =   3.36868932d-09
      msq4(+3,+2,+3,+2) =   1.85647923d-08
      msq4(+3,+3,+3,+3) =   5.53535425d-09
      msq4(+3,+4,+3,+4) =   1.85647923d-08
      msq4(+4,-4,+1,-1) =   1.64142402d-08
      msq4(+4,-4,+2,-2) =   1.86666079d-08
      msq4(+4,-4,+3,-3) =   1.64142402d-08
      msq4(+4,-4,+4,-4) =   5.23542903d-08
      msq4(+4,-3,+4,-3) =   4.33211586d-09
      msq4(+4,-2,+4,-2) =   3.22314149d-08
      msq4(+4,-1,+4,-1) =   4.33211586d-09
      msq4(+4,+1,+4,+1) =   6.53442134d-09
      msq4(+4,+2,+4,+2) =   1.34747573d-08
      msq4(+4,+3,+4,+3) =   6.53442134d-09
      msq4(+4,+4,+4,+4) =   2.2141417d-08
      endif

      if (Gflag) then
      msq4save=msq4
      msq4=0d0
      msq4(-5, 0,-5, 0) =   1.35883084d-08
      msq4(-5,+5, 0, 0) =   4.02258223d-08
      msq4(-4, 0,-4, 0) =   5.43532337d-08
      msq4(-4,+4, 0, 0) =   1.60903289d-07
      msq4(-3, 0,-3, 0) =   1.35883084d-08
      msq4(-3,+3, 0, 0) =   4.02258223d-08
      msq4(-2, 0,-2, 0) =   5.43532337d-08
      msq4(-2,+2, 0, 0) =   1.60903289d-07
      msq4(-1, 0,-1, 0) =   1.35883084d-08
      msq4(-1,+1, 0, 0) =   4.02258223d-08
      msq4( 0,-5, 0,-5) =   4.76316508d-08
      msq4( 0,-4, 0,-4) =   1.90526603d-07
      msq4( 0,-3, 0,-3) =   4.76316508d-08
      msq4( 0,-2, 0,-2) =   1.90526603d-07
      msq4( 0,-1, 0,-1) =   4.76316508d-08
      msq4( 0, 0,+1,-1) =   3.65413388d-10
      msq4( 0, 0,+2,-2) =   1.46165355d-09
      msq4( 0, 0,+3,-3) =   3.65413388d-10
      msq4( 0, 0,+4,-4) =   1.46165355d-09
      msq4( 0, 0,+5,-5) =   3.65413388d-10
      msq4( 0,+1, 0,+1) =   4.76316508d-08
      msq4( 0,+2, 0,+2) =   1.90526603d-07
      msq4( 0,+3, 0,+3) =   4.76316508d-08
      msq4( 0,+4, 0,+4) =   1.90526603d-07
      msq4( 0,+5, 0,+5) =   4.76316508d-08
      msq4(+1,-1, 0, 0) =   4.02258223d-08
      msq4(+1, 0,+1, 0) =   1.35883084d-08
      msq4(+2,-2, 0, 0) =   1.60903289d-07
      msq4(+2, 0,+2, 0) =   5.43532337d-08
      msq4(+3,-3, 0, 0) =   4.02258223d-08
      msq4(+3, 0,+3, 0) =   1.35883084d-08
      msq4(+4,-4, 0, 0) =   1.60903289d-07
      msq4(+4, 0,+4, 0) =   5.43532337d-08
      msq4(+5,-5, 0, 0) =   4.02258223d-08
      msq4(+5, 0,+5, 0) =   1.35883084d-08
      msq4=msq4+msq4save
      endif


      do j=-nf,nf
      do k=-nf,nf
      msq(j,k)=0d0
c fill final-state b entries
      msq4(1,-1,5,-5)=msq4(1,-1,3,-3)
      msq4(2,-2,5,-5)=msq4(2,-2,3,-3)
      msq4(3,-3,5,-5)=msq4(3,-3,1,-1)
      msq4(4,-4,5,-5)=msq4(4,-4,3,-3)
      msq4(-1,1,-5,5)=msq4(-1,1,-3,3)
      msq4(-2,2,-5,5)=msq4(-2,2,-3,3)
      msq4(-3,3,-5,5)=msq4(-3,3,-1,1)
      msq4(-4,4,-5,5)=msq4(-4,4,-3,3)
      msq4(0,0,-5,5)=msq4(0,0,-3,3)
      do m=-nf,nf
      do n=-nf,nf
      msq(j,k)=msq(j,k)+msq4(j,k,m,n)
      enddo
      enddo
      enddo
      enddo

      return
      end


